<?xml version="1.0"?>
<robot xmlns:sensor="http://playerstage.sourceforge.net/gazebo/xmlschema/#sensor" 
   xmlns:controller="http://playerstage.sourceforge.net/gazebo/xmlschema/#controller" 
   xmlns:interface="http://playerstage.sourceforge.net/gazebo/xmlschema/#interface" 
   xmlns:xacro="http://ros.org/wiki/xacro" name="egp_40">


   <xacro:macro name="cylinder_inertia" params="m r h">
      <inertia ixx="${m*(3*r*r+h*h)/12}" ixy = "0" ixz = "0" iyy="${m*(3*r*r+h*h)/12}" iyz = "0" izz="${m*r*r/2}" />
   </xacro:macro>

   <xacro:macro name="default_transmission" params="jname">
    <transmission name="${jname}_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <joint name="${jname}_joint">
        <hardwareInterface>PositionJointInterface</hardwareInterface>
        <hardwareInterface>VelocityJointInterface</hardwareInterface>
        <!--hardwareInterface>EffortJointInterface</hardwareInterface-->
      </joint>
      <actuator name="${jname}_motor">
        <mechanicalReduction>1</mechanicalReduction>
      </actuator>
    </transmission>
  </xacro:macro>

   <xacro:macro name="schunk_egp_40" params="prefix parent *origin">

      <joint name="${prefix}base_joint" type="fixed">
         <xacro:insert_block name="origin"/>
         <parent link="${parent}"/>
         <child link="${prefix}base_link"/>
      </joint>

      <!-- BASE LINK -->
      <link name="${prefix}base_link">
         <inertial>
            <mass value="0.25" />
            <origin xyz="0 0 0" />
            <cylinder_inertia m="0.20" r="0.05" h="0.05" />
         </inertial>

         <visual>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_base.stl" scale="1 1 1"/>
            </geometry>
            <material name="grey">
               <color rgba="0.5 0.5 0.5 1"/>
            </material>
         </visual>

         <collision>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_base.stl" scale="1 1 1"/>
            </geometry>
         </collision>
      </link>

      <gazebo reference="${prefix}base_link">
         <material>Gazebo/Grey</material>
         <turnGravityOff>false</turnGravityOff>
      </gazebo>

      <!-- GRIPPER FINGER LEFT -->
      <joint name="${prefix}left_finger_base_joint" type="prismatic">
         <parent link="${prefix}base_link"/>
         <child link="${prefix}left_finger_base_link"/>
         <origin xyz="-0.012 0 0.08915" rpy="0 0 0" />
         <axis xyz="-1 0 0" />
         <limit effort="10" lower="0.001" upper="0.015" velocity="0.041"/>
      </joint>

      <link name="${prefix}left_finger_base_link">
         <inertial>
            <mass value="0.02" />
            <origin xyz="0 0 0" />
            <cylinder_inertia m="0.02" r="0.01" h="0.01" />
         </inertial>

         <visual>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger_base.stl" scale="1 1 1"/>
            </geometry>
            <material name="grey">
               <color rgba="0.5 0.5 0.5 1"/>
            </material>
         </visual>

         <collision>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger_base.stl" scale="1 1 1"/>
            </geometry>
         </collision>
      </link>

      <joint name="${prefix}left_finger_joint" type="fixed">
         <parent link="${prefix}left_finger_base_link"/>
         <child link="${prefix}left_finger_link"/>
         <origin xyz="0.012 0 0.05" rpy="0 0 0" />
      </joint>

      <link name="${prefix}left_finger_link">
         <inertial>
            <mass value="0.02" />
            <origin xyz="0 0 0" />
            <cylinder_inertia m="0.02" r="0.01" h="0.01" />
         </inertial>

         <visual>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger.stl" scale="1 1 1"/>
            </geometry>
            <material name="grey">
               <color rgba="0.5 0.5 0.5 1"/>
            </material>
         </visual>

         <collision>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger.stl" scale="1 1 1"/>
            </geometry>
         </collision>
      </link>


      <!-- GRIPPER FINGER RIGHT -->
      <joint name="${prefix}right_finger_base_joint" type="prismatic">
         <parent link="${prefix}base_link"/>
         <child link="${prefix}right_finger_base_link"/>
         <origin xyz="0.012 0 0.08915" rpy="0 0 3.14" />
         <axis xyz="-1 0 0" />
         <limit effort="10" lower="0.001" upper="0.015" velocity="0.041"/>
      </joint>

      <link name="${prefix}right_finger_base_link">
         <inertial>
            <mass value="0.02" />
            <origin xyz="0 0 0" />
            <cylinder_inertia m="0.02" r="0.01" h="0.01" />
         </inertial>

         <visual>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger_base.stl" scale="1 1 1"/>
            </geometry>
            <material name="grey">
               <color rgba="0.5 0.5 0.5 1"/>
            </material>
         </visual>

         <collision>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger_base.stl" scale="1 1 1"/>
            </geometry>
         </collision>
      </link>

      <joint name="${prefix}right_finger_joint" type="fixed">
         <parent link="${prefix}right_finger_base_link"/>
         <child link="${prefix}right_finger_link"/>
         <origin xyz="0.012 0 0.05" rpy="0 0 0" />
      </joint>

      <link name="${prefix}right_finger_link">
         <inertial>
            <mass value="0.02" />
            <origin xyz="0 0 0" />
            <cylinder_inertia m="0.02" r="0.01" h="0.01" />
         </inertial>

         <visual>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger.stl" scale="1 1 1"/>
            </geometry>
            <material name="grey">
               <color rgba="0.5 0.5 0.5 1"/>
            </material>
         </visual>

         <collision>
            <origin xyz="0.0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://icclab_turtlebot/meshes/gripper/schunk_epg40/schunk_epg40_finger.stl" scale="1 1 1"/>
            </geometry>
         </collision>
      </link>

    <xacro:default_transmission jname="${prefix}left_finger_base"/>
    <xacro:default_transmission jname="${prefix}right_finger_base"/>

   </xacro:macro>

</robot>

